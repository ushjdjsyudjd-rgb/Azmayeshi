<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ø§Ù¾Ù„ÛŒÚ©ÛŒØ´Ù† Ø´Ø¹Ø¨Ù‡ Ú¯ÛŒÙ„ Ø±Ø´Øª</title>
    <style>
        body { font-family: Tahoma, Arial, sans-serif; background-color: #f8fafc; margin: 0; padding: 0; direction: rtl; -webkit-tap-highlight-color: transparent; }
        
        /* Splash Screen */
        #splash-screen { position: fixed; inset: 0; z-index: 9999; background: #0d66a1; display: flex; flex-direction: column; align-items: center; justify-content: center; color: white; transition: opacity 0.5s; }
        
        /* Layout */
        .page { display: none; padding: 16px; min-height: 100vh; box-sizing: border-box; }
        .active-page { display: block; }
        
        /* Main Page Components */
        .bmi-card { background: linear-gradient(135deg, #0d66a1 0%, #228cc8 100%); border-radius: 35px; padding: 30px 20px; color: white; text-align: center; box-shadow: 0 10px 25px rgba(13,102,161,0.2); margin-bottom: 25px; }
        .digital-clock { font-size: 3.5rem; font-weight: bold; font-family: sans-serif; margin-bottom: 10px; }
        .shamsi-box { background: rgba(255,255,255,0.15); padding: 8px 20px; border-radius: 50px; display: inline-block; font-size: 13px; }
        
        .service-row { background: white; border-radius: 20px; padding: 15px; margin-bottom: 12px; display: flex; align-items: center; justify-content: space-between; box-shadow: 0 2px 8px rgba(0,0,0,0.05); cursor: pointer; border: 1px solid #f1f5f9; }
        .icon-sq { width: 45px; height: 45px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 20px; margin-left: 12px; }
        
        /* Chat UI Fixes */
        .chat-container { display: flex; flex-direction: column; height: 100vh; background: #f1f5f9; position: fixed; inset: 0; z-index: 100; padding: 0 !important; }
        .messages-area { flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 10px; }
        .bubble { max-width: 80%; padding: 12px 18px; border-radius: 20px; font-size: 14px; line-height: 1.5; position: relative; min-width: 60px; }
        .user-bubble { align-self: flex-end; background: #0d66a1; color: white; border-bottom-right-radius: 5px; text-align: right; }
        .admin-bubble { align-self: flex-start; background: white; color: #334155; border-bottom-left-radius: 5px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .chat-footer { padding: 10px; background: white; display: flex; gap: 8px; border-top: 1px solid #ddd; }
        .chat-input { flex: 1; border: 1px solid #eee; background: #f8fafc; padding: 12px; border-radius: 15px; outline: none; }
        .send-btn { background: #0d66a1; color: white; border: none; padding: 0 20px; border-radius: 15px; font-weight: bold; }

        /* Modal */
        #contactModal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 200; align-items: center; justify-content: center; padding: 20px; }
        .modal-content { background: white; width: 100%; border-radius: 30px; overflow: hidden; }
    </style>
</head>
<body>

    <div id="splash-screen">
        <h1 style="font-size: 24px;">Ø¨Ø§Ù†Ú© Ù…Ù„ÛŒ Ø§ÛŒØ±Ø§Ù†</h1>
        <p>Ø´Ø¹Ø¨Ù‡ Ú¯ÛŒÙ„ Ø±Ø´Øª</p>
    </div>

    <div id="main-page" class="page active-page">
        <div class="bmi-card">
            <div id="digiClock" class="digital-clock">00:00</div>
            <div class="shamsi-box" id="shamsiDate">...</div>
            <div style="margin-top:15px;">
                <button onclick="toggleModal(true)" style="background:rgba(255,255,255,0.2); border:1px solid white; color:white; padding:10px 25px; border-radius:50px; cursor:pointer;">ğŸ“ ØªÙ…Ø§Ø³ Ø¨Ø§ Ø´Ø¹Ø¨Ù‡</button>
            </div>
        </div>

        <div class="service-row" onclick="window.location.href='https://baam.bmi.ir'">
            <div style="display:flex; align-items:center;">
                <div class="icon-sq" style="background:#eff6ff; color:#2563eb;">ğŸŒ</div>
                <div style="text-align:right;"><b style="font-size:14px;">Ù‡Ù…Ø±Ø§Ù‡ Ø¨Ø§Ù… Ù…Ù„ÛŒ</b><br><small style="color:#94a3b8;">Ø³Ø§Ù…Ø§Ù†Ù‡ Ø®Ø¯Ù…Ø§Øª Ø§ÛŒÙ†ØªØ±Ù†ØªÛŒ</small></div>
            </div>
            <span>â®</span>
        </div>

        <div class="service-row" onclick="showPage('form-page')" style="border: 2px solid #0d66a1; margin-top:20px;">
            <div style="display:flex; align-items:center;">
                <div class="icon-sq" style="background:#0d66a1; color:white;">ğŸ“</div>
                <b style="font-size:15px; color:#0d66a1;">ÙØ±Ù… Ù¾Ø±Ø³Ø´Ù†Ø§Ù…Ù‡ Ù…Ø´ØªØ±ÛŒØ§Ù†</b>
            </div>
            <span style="color:#0d66a1; font-weight:bold;">Ø´Ø±ÙˆØ¹ â¯</span>
        </div>
    </div>

    <div id="chat-page" class="page chat-container">
        <div style="padding:15px; background:#0d66a1; color:white; display:flex; justify-content:space-between; align-items:center;">
            <button onclick="showPage('main-page')" style="background:none; border:none; color:white; font-size:18px;">âœ•</button>
            <b style="font-size:16px;">Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø¢Ù†Ù„Ø§ÛŒÙ† Ø´Ø¹Ø¨Ù‡</b>
            <div style="width:20px;"></div>
        </div>
        <div id="chat-messages" class="messages-area">
            </div>
        <div class="chat-footer">
            <input type="text" id="user-input" class="chat-input" placeholder="Ù¾ÛŒØ§Ù… Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯...">
            <button onclick="sendChatMessage()" class="send-btn">Ø§Ø±Ø³Ø§Ù„</button>
        </div>
    </div>

    <div id="form-page" class="page bg-white">
        <button onclick="showPage('main-page')" style="margin-bottom:20px; border:none; background:none; color:#0d66a1; font-weight:bold;">â® Ø¨Ø§Ø²Ú¯Ø´Øª</button>
        <h3>ØªÚ©Ù…ÛŒÙ„ Ø§Ø·Ù„Ø§Ø¹Ø§Øª</h3>
        <input type="text" placeholder="Ù†Ø§Ù… Ùˆ Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ" style="width:100%; padding:15px; border-radius:10px; border:1px solid #ddd; margin-bottom:15px;">
        <button style="width:100%; padding:15px; background:#0d66a1; color:white; border:none; border-radius:10px; font-weight:bold;">Ø«Ø¨Øª Ø§Ø·Ù„Ø§Ø¹Ø§Øª</button>
    </div>

    <div id="contactModal" onclick="toggleModal(false)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div style="padding:20px; background:#0d66a1; color:white; text-align:center;"><b>Ø§Ù†ØªØ®Ø§Ø¨ Ù†ÙˆØ¹ Ø§Ø±ØªØ¨Ø§Ø·</b></div>
            <div style="padding:20px;">
                <button onclick="openChat()" style="width:100%; padding:15px; background:#10b981; color:white; border:none; border-radius:15px; font-weight:bold; margin-bottom:15px;">ğŸ’¬ Ú†Øª Ø¢Ù†Ù„Ø§ÛŒÙ† Ø¨Ø§ Ø´Ø¹Ø¨Ù‡</button>
                <a href="tel:01333666474" style="display:block; text-align:center; padding:12px; background:#f1f5f9; border-radius:50px; text-decoration:none; color:#334155; margin-bottom:10px;">ğŸ“ ØªÙ…Ø§Ø³ Ø¨Ø§ Ø±ÛŒØ§Ø³Øª</a>
                <a href="tel:01333663062" style="display:block; text-align:center; padding:12px; background:#f1f5f9; border-radius:50px; text-decoration:none; color:#334155;">ğŸ“ ØªÙ…Ø§Ø³ Ø¨Ø§ Ø§Ø¹ØªØ¨Ø§Ø±Ø§Øª</a>
            </div>
        </div>
    </div>

    <script>
        const CHAT_API = 'https://sheetdb.io/api/v1/czatwlt4x2234';

        function showPage(id) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active-page'));
            document.getElementById(id).classList.add('active-page');
            if(id === 'chat-page') fetchMessages();
        }

        function toggleModal(s) { document.getElementById('contactModal').style.display = s ? 'flex' : 'none'; }
        function openChat() { toggleModal(false); showPage('chat-page'); }

        // Ø³Ø§Ø¹Øª
        setInterval(() => {
            const n = new Date();
            document.getElementById('digiClock').textContent = String(n.getHours()).padStart(2,'0') + ":" + String(n.getMinutes()).padStart(2,'0');
        }, 1000);
        document.getElementById('shamsiDate').textContent = new Intl.DateTimeFormat('fa-IR', {dateStyle:'full'}).format(new Date());

        // ØªÙˆØ§Ø¨Ø¹ Ú†Øª
        async function sendChatMessage() {
            const input = document.getElementById('user-input');
            const txt = input.value.trim();
            if(!txt) return;
            
            // Ù†Ù…Ø§ÛŒØ´ Ù…ÙˆÙ‚Øª Ù¾ÛŒØ§Ù… Ú©Ø§Ø±Ø¨Ø± Ø¨Ø±Ø§ÛŒ Ø³Ø±Ø¹Øª Ø¨ÛŒØ´ØªØ±
            const cBox = document.getElementById('chat-messages');
            cBox.innerHTML += `<div class="bubble user-bubble"><small style="display:block; opacity:0.7; font-size:9px;">Ù…Ø´ØªØ±ÛŒ</small>${txt}</div>`;
            input.value = '';
            cBox.scrollTop = cBox.scrollHeight;

            try {
                await fetch(CHAT_API, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({data: [{sender: 'Ù…Ø´ØªØ±ÛŒ', message: txt, role: 'user', timestamp: new Date().toLocaleTimeString('fa-IR')}]})
                });
                fetchMessages();
            } catch(e) {}
        }

        async function fetchMessages() {
            try {
                const res = await fetch(CHAT_API);
                const data = await res.json();
                const cBox = document.getElementById('chat-messages');
                cBox.innerHTML = data.map(m => `
                    <div class="bubble ${m.role==='user'?'user-bubble':'admin-bubble'}">
                        <small style="display:block; opacity:0.7; font-size:9px;">${m.sender}</small>${m.message}
                    </div>
                `).join('');
                cBox.scrollTop = cBox.scrollHeight;
            } catch(e) {}
        }

        window.onload = () => {
            setTimeout(() => { 
                document.getElementById('splash-screen').style.opacity = '0';
                setTimeout(() => document.getElementById('splash-screen').remove(), 500);
            }, 2000);
        };

        // Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø®ÙˆØ¯Ú©Ø§Ø± Ú†Øª Ù‡Ø± 10 Ø«Ø§Ù†ÛŒÙ‡ Ø§Ú¯Ø± ØµÙØ­Ù‡ Ú†Øª Ø¨Ø§Ø² Ø¨Ø§Ø´Ø¯
        setInterval(() => {
            if(document.getElementById('chat-page').classList.contains('active-page')) fetchMessages();
        }, 10000);
    </script>
</body>
</html>
